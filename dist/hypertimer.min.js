/**
 * hypertimer.js
 * https://github.com/enmasseio/hypertimer
 *
 * A timer running faster or slower than real-time, and in continuous or
 * discrete time.
 *
 * @version 0.2.0-SNAPSHOT
 * @date    2014-07-16
 *
 * @license
 * Copyright (C) 2014 Almende B.V., http://almende.com
 *
 * Licensed under the Apache License, Version 2.0 (the "License"); you may not
 * use this file except in compliance with the License. You may obtain a copy
 * of the License at
 *
 * http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
 * WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
 * License for the specific language governing permissions and limitations under
 * the License.
 */
!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define(t):"object"==typeof exports?exports.hypertimer=t():e.hypertimer=t()}(this,function(){return function(e){function t(r){if(n[r])return n[r].exports;var i=n[r]={exports:{},id:r,loaded:!1};return e[r].call(i.exports,i,i.exports,t),i.loaded=!0,i.exports}var n={};return t.m=e,t.c=n,t.p="",t(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){function r(e){function t(e){if(s.length>0){for(var t=s.length-1;t>=0&&s[t].time>e.time;)t--;s.splice(t+1,0,e)}else s.push(e)}function n(e,n){function r(){if(e.type===o.INTERVAL&&m[e.id]){var r=a===u||a>=0?1:-1;e.time+=e.interval*r,t(e)}delete m[e.id],"function"==typeof n&&n()}m[e.id]=e;try{0==e.callback.length?(e.callback(),r()):e.callback(r)}catch(i){r()}}function r(){function e(){function e(){var t=o.shift();t?n(t,e):r()}a===u&&(l=i);for(var t=0;t<s.length&&(s[t].time<=i||!isFinite(s[t].time));)t++;var o=s.splice(0,t);a===u?e():(o.forEach(n),r())}if(!(a===u&&Object.keys(m).length>0)){var t=s[0];if(p&&(clearTimeout(p),p=null),f&&t){var i=t.time,o=i-v.now(),c=a===u?0:o/a;p=setTimeout(e,c)}}}var a=1,f=!1,c=null,l=null,s=[],m={},p=null,b=0,v={};return v.config=function(e){if(e&&"rate"in e){var t=e.rate===u?u:Number(e.rate);if(t!==u&&isNaN(t))throw new TypeError('rate must be a number or string "discrete"');l=v.now(),c=i.nowReal(),a=t}return r(),{rate:a}},v.setTime=function(e){if(e instanceof Date)l=e.valueOf();else{var t=Number(e);if(isNaN(t))throw new TypeError("time must be a Date or number");l=t}r()},v.now=function(){if(a===u)return l;if(f){var e=i.nowReal()-c,t=e*a;return l+t}return l},v["continue"]=function(){c=i.nowReal(),f=!0,r()},v.pause=function(){l=v.now(),c=null,f=!1,r()},v.getTime=function(){return new Date(v.now())},v.valueOf=v.getTime,v.toString=function(){return v.getTime().toString()},v.setTimeout=function(e,n){var i=b++,u=v.now()+n;if(isNaN(u))throw new TypeError("delay must be a number");return t({id:i,type:o.TIMEOUT,time:u,callback:e}),r(),i},v.setTrigger=function(e,n){var i=b++,u=Number(n);if(isNaN(u))throw new TypeError("time must be a Date or number");return t({id:i,type:o.TRIGGER,time:u,callback:e}),r(),i},v.setInterval=function(e,n,i){var u=b++,a=Number(n);if(isNaN(a))throw new TypeError("interval must be a number");(0>a||!isFinite(a))&&(a=0);var f;if(void 0!=i){if(f=Number(i),isNaN(f))throw new TypeError("firstTime must be a Date or number")}else f=v.now()+a;return t({id:u,type:o.INTERVAL,time:f,interval:a,callback:e}),r(),u},v.clearTimeout=function(e){if(m[e])return void delete m[e];for(var t=0;t<s.length;t++)if(s[t].id===e){s.splice(t,1),r();break}},v.clearTrigger=v.clearTimeout,v.clearInterval=v.clearTimeout,v.list=function(){return s.map(function(e){return e.id})},v.clear=function(){m={},s=[],r()},Object.defineProperty(v,"running",{get:function(){return f}}),v.config(e),v.setTime(i.nowReal()),v.continue(),v}var i=n(2),o={TIMEOUT:0,INTERVAL:1,TRIGGER:2},u="discrete";e.exports=r},function(e,t){t.nowReal="function"==typeof Date.now?function(){return Date.now()}:function(){return(new Date).valueOf()}}])});
//# sourceMappingURL=hypertimer.map